---

import Layout from '../../layouts/Layout.astro';
import ChatMessage from '../../components/projects/wielomiany/ChatMessage.astro';
import UserMessage from '../../components/projects/wielomiany/UserMessage.astro';
---
<Layout>
	<main class="bg-[#212121]">
		<section class="flex items-center justify-center flex-col font-sans font-bold h-[92.5vh]">
			<div class="flex flex-col items-left justify-center sm:w-2/3 w-3/4">
				<h1 class="text-zinc-50 lg:text-[6vw] md:text-[7vw] sm:text-[9vw] text-[10vw] pr-2">Wielomiany</h1>
				<h2 class="text-zinc-300 lg:text-[2vw] md:text-[3vw] sm:text-[4vw] text-[5vw] font-medium">Interaktywne narzędzie do nauki i analizy wielomianów - odkryj definicje, własności oraz metody rozwiązywania równań wielomianowych.</h2>
			</div>
		</section>
		<section class="snap-start pb-10">
			<UserMessage>
				<p>Piszesz notatke dla uczniów 2 klasy technikum z matematyki rozszerzonej. Temat to wielomiany. Napisz szybkie wprowadzenie do wielomianów.</p>
			</UserMessage>
			<ChatMessage>
				<h1 class="text-[#ECECEC] whitespace-pre-wrap font-bold sm:text-lg text-xl">Wprowadzenie do wielomianów</h1>
				<br>
				<h2 class="text-[#ECECEC] whitespace-pre-wrap font-semibold sm:text-base text-lg mt-8">Definicja wielomianu</h2>
				<br>
				<p>Wielomian to wyrażenie algebraiczne postaci:</p>
				<p class="text-sm" is:raw>$$W(x) = a_n x^n + a_{n-1} x^{n-1} + \ldots + a_1 x + a_0$$</p>
				<p>gdzie:</p>
				<ul>
					<li>\(n\) - stopień wielomianu (najwyższa potęga \(x\)),</li>
					<li is:raw>\(a_n, a_{n-1}, \ldots, a_1, a_0\) - współczynniki wielomianu (liczby rzeczywiste),</li>
					<li>\(a_n \neq 0\).</li>
				</ul>
				<h2 class="text-[#ECECEC] whitespace-pre-wrap font-semibold text-lg mt-6">Przykłady wielomianów</h2>
				<ol>
					<li>\(W(x) = 3x^4 + 2x^2 + 5x - 7\) (stopień 4)</li>
					<li>\(W(x) = x^3 - 2x^2 + 3x - 1\) (stopień 3)</li>
					<li>\(W(x) = 2x + 1\) (stopień 1 - funkcja liniowa to też wielomian!)</li>
				</ol>
				<h2 class="text-[#ECECEC] whitespace-pre-wrap font-semibold text-lg mt-6">Podstawowe własności wielomianów</h2>
				<ul>
					<li><strong class="font-medium">Suma i różnica wielomianów</strong> - dodajemy/odejmujemy współczynniki przy tych samych potęgach \(x\).</li>
					<li><strong class="font-medium">Mnożenie wielomianów</strong> - stosujemy rozdzielność mnożenia względem dodawania.</li>
					<li><strong class="font-medium">Dzielenie wielomianów</strong> - można stosować schemat Hornera lub klasyczne dzielenie pisemne.</li>
				</ul>
				<h2 class="text-[#ECECEC] whitespace-pre-wrap font-semibold text-lg mt-6">Pierwiastki wielomianu</h2>
				<p>Liczba \(x_0\) jest pierwiastkiem wielomianu \(W(x)\), jeśli:</p>
				<p is:raw>$$W(x_0) = 0$$</p>
				<p>Przykład: Jeśli \(W(x) = x^2 - 4\), to \(x = 2\) i \(x = -2\) są pierwiastkami tego wielomianu (bo \(W(2) = 0\) i \(W(-2) = 0\)).</p>
				<p class="text-base mt-6">To podstawowe pojęcia, które będą potrzebne do dalszej nauki o wielomianach!</p>	
			</ChatMessage>
			<UserMessage>
				<p>Czym jest schemat Hornera?</p>
			</UserMessage>
			<ChatMessage>
				<h1 class="text-[#ECECEC] whitespace-pre-wrap font-bold text-xl">Schemat Hornera</h1>
				<p class="text-base mt-6">Schemat Hornera to metoda umożliwiająca szybkie:</p>
				<ul>
					<li>obliczanie wartości wielomianu dla danego \(x_0\)</li>
					<li>Dzielenie wielomianu przez dwumian \((x-x_0)\)</li>
					<li>obliczanie pierwiastków wielomianu.</li>
				</ul>

				<hr class="border-[#555555] mb-16 mt-8">

				<h1 class="text-[#ECECEC] whitespace-pre-wrap font-bold text-xl">1. Obliczanie wartości</h1>
				<p class="text-base mt-4">Rozważmy wielomian:</p>
				<p is:raw>$$W(x) = 2x^3 - 3x^2 + 4x - 5$$</p>
				<p>Chcemy obliczyć \(W(2)\).</p>
				<h2 class="text-[#ECECEC] whitespace-pre-wrap font-semibold text-lg mt-6">Krok 1: Wypisz współczynniki</h2>
				<p>$$2, -3, 4, -5$$</p>
				<h2 class="text-[#ECECEC] whitespace-pre-wrap font-semibold text-lg mt-6">Krok 2: Wykonaj schemat Hornera</h2>
				<ol>
					<li>Przepisujemy pierwszy współczynnik.</li>
					<li>Mnożymy go przez \(x_0 = 2\) i dodajemy do następnego współczynnika.</li>
					<li>Powtarzamy ten proces aż do końca.</li>
				</ol>
				<p is:raw class="text-[#ECECEC] whitespace-pre-wrap">
					\[
					\begin{array}{r|rrrr}
					  2 & 2 & -3 & 4 & -5  \\ 
						&   & 4  & 2 & 12   \\ 
					  \hline
						& 2 & 1 & 6  & 7   \\
					\end{array}
					\]
				</p>
				<h2 class="text-[#ECECEC] whitespace-pre-wrap font-semibold text-lg">Odpowiedź: \(W(2) = 7\).</h2>

				<hr class="border-[#555555] mb-16 mt-8">

				<h1 class="text-[#ECECEC] whitespace-pre-wrap font-bold text-xl">2. Dzielenie wielomianu przez \((x-x_0)\)</h1>
				
				<p class=" text-base mt-4">Schemat Hornera pozwala również podzielić \(W(x)\) przez \((x-x+0)\).</p>

				<ul>
					<li>Wynik dzielenia to nowy wielomian (bez reszty, jeśli \(x_0\) jest pierwiastkiem).</li>
					<li>Reszta z dzielenia to ostatnia liczba w schemacie.</li>
				</ul>

				<p class=" text-base mt-4">Dla \(W(x)=2x^3-3x^3+4x-5\) i \((x-2)\), reszta to \(7\), więc \((x-2)\) nie jest czynnikiem \(W(x)\)</p>

				<p class=" text-base mt-8"><strong class="font-semibold">Nowy wielomian</strong> (bez reszty):</p>
				<p>$$2x^2+x+6$$</p>

				<hr class="border-[#555555] mb-16 mt-8">

				<h1 class="text-[#ECECEC] whitespace-pre-wrap font-bold text-xl">Kiedy stosować schemat Hornera?</h1>
				<ul>
					<li>Obliczanie wartości \(W(x)\) w jednym punkcie</li>
					<li>Dzielenie wielomianu przez \((x-x_0)\)</li>
					<li>Sprzwdzanie, czy \(x_0\) jest pierwiastkiem wielomianu</li>
				</ul>
				<p class=" text-base mt-4">Metoda jest szybka i eliminuje długie obliczenia ręczne!</p>
			</ChatMessage>
			<UserMessage>
				<p>Jest jakiś prostszy sposób na tą całą metodę Hornera?</p>
			</UserMessage>
			<ChatMessage>
				<h1 class="text-[#ECECEC] whitespace-pre-wrap font-bold text-xl mb-8">Spróbuj tych narzędzi dotyczących wielomianów które dla ciebie stworzyłem!</h1>

				<h1 class="text-[#ECECEC] whitespace-pre-wrap font-bold text-xl mb-8">Interaktywny kalkulator wielomianów</h1>

				<div class="flex flex-col gap-6 w-full">
					<div class="p-6 border border-[#444] rounded-lg bg-[#2A2A2A] w-full shadow-lg">
						<div class="grid grid-cols-1 md:grid-cols-2 gap-6">
						<div>
							<h2 class="text-[#ECECEC] font-semibold text-lg mb-4">Kreator wielomianu</h2>

							<div class="grid grid-cols-2 sm:grid-cols-4 gap-3 mb-5">
								<div class="flex flex-col">
									<span class="text-[#AAA] text-xs mb-1 text-center">x³</span>
									<div class="flex">
										<button class="px-3 py-2 rounded-l bg-[#444] text-[#ECECEC] hover:bg-[#555] flex-1" onclick="addTerm(3)">+</button>
										<button class="px-3 py-2 rounded-r bg-[#444] text-[#ECECEC] hover:bg-[#555] border-l border-[#333] flex-1" onclick="subtractTerm(3)">−</button>
									</div>
								</div>
								
								<div class="flex flex-col">
									<span class="text-[#AAA] text-xs mb-1 text-center">x²</span>
									<div class="flex">
										<button class="px-3 py-2 rounded-l bg-[#444] text-[#ECECEC] hover:bg-[#555] flex-1" onclick="addTerm(2)">+</button>
										<button class="px-3 py-2 rounded-r bg-[#444] text-[#ECECEC] hover:bg-[#555] border-l border-[#333] flex-1" onclick="subtractTerm(2)">−</button>
									</div>
								</div>
								
								<div class="flex flex-col">
									<span class="text-[#AAA] text-xs mb-1 text-center">x</span>
									<div class="flex">
										<button class="px-3 py-2 rounded-l bg-[#444] text-[#ECECEC] hover:bg-[#555] flex-1" onclick="addTerm(1)">+</button>
										<button class="px-3 py-2 rounded-r bg-[#444] text-[#ECECEC] hover:bg-[#555] border-l border-[#333] flex-1" onclick="subtractTerm(1)">−</button>
									</div>
								</div>
								
								<div class="flex flex-col">
									<span class="text-[#AAA] text-xs mb-1 text-center">stała</span>
									<div class="flex">
										<button class="px-3 py-2 rounded-l bg-[#444] text-[#ECECEC] hover:bg-[#555] flex-1" onclick="addTerm(0)">+</button>
										<button class="px-3 py-2 rounded-r bg-[#444] text-[#ECECEC] hover:bg-[#555] border-l border-[#333] flex-1" onclick="subtractTerm(0)">−</button>
									</div>
								</div>
							</div>

							<button class="px-3 py-2 rounded bg-red-500 text-white hover:opacity-80 w-full text-sm mb-4" onclick="resetPolynomial()">Reset</button>

							<div class="text-[#ECECEC] text-xl p-3 font-mono bg-[#212121] rounded-md border border-[#333] shadow-inner mb-4 overflow-x-auto" id="currentPolynomial">W(x) = 0</div>
							<input type="hidden" id="coefficients" value="0">
						</div>
						
						<div>
							<h2 class="text-[#ECECEC] font-semibold text-lg mb-4">Schemat Hornera</h2>
						
							<div class="bg-[#333] rounded-md p-4 mb-5 border-l-2 border-[#ECECEC]">
								<p class="text-[#ECECEC] text-sm mb-3">Wpisz wartość <strong>c</strong> dla dzielnika postaci <strong>(x − c)</strong>:</p>
								<div class="flex items-center">
									<div class="flex-shrink-0 font-mono text-[#ECECEC] text-lg mr-2">(x −</div>
										<input type="number" id="divisor" placeholder="2" class="w-full p-3 rounded-md border border-[#444] bg-[#212121] text-[#ECECEC] text-center">
									<div class="flex-shrink-0 font-mono text-[#ECECEC] text-lg ml-2">)</div>
								</div>
							</div>
						</div>
					</div>
					<div class="flex flex-row gap-3 mt-8 flex-wrap">
						<button onclick="calculateRuffini()" class="grow flex h-12 px-6 items-center justify-center rounded-md transition-colors bg-[#ECECEC] text-[#333333] hover:bg-[#c7c7c7] text-base font-medium">
							Oblicz metodą Hornera
						</button>
						
						<button onclick="drawPolynomialGraph()" class="grow flex h-12 px-6 items-center justify-center rounded-md bg-[#ECECEC] text-[#333333] hover:bg-[#c7c7c7] text-base">
							Pokaż wykres
						</button>
	
						<button onclick="toggleRoots()" class="grow flex h-12 px-6 items-center justify-center rounded-md bg-[#ECECEC] text-[#333333] hover:bg-[#c7c7c7] text-base">
							Pokaż miejsca zerowe
						</button>
					</div>
				</div>

				<div class="bg-[#2A2A2A] border border-[#444] rounded-lg p-6 shadow-lg">
					<h2 class="text-[#ECECEC] font-semibold text-lg mb-4">Wyniki obliczeń</h2>

					<div class="output text-[#ECECEC] whitespace-pre-wrap mb-6 bg-[#212121] p-4 rounded-md border border-[#333]" id="result">
					<p class="text-[#888] text-sm">Tutaj pojawi się wynik obliczeń metodą Hornera.</p>
					</div>

					<div class="w-full">
					<div class="relative w-full" style="height: 0; padding-bottom: 56.25%;">
						<canvas id="polynomialGraph" class="absolute top-0 left-0 w-full h-full bg-[#303030] rounded-lg border border-[#444]"></canvas>
					</div>
					</div>
				</div>
				</div>
			</ChatMessage>
			<UserMessage>
				<p>Możesz mi dać jakieś zadanie z wykorzystaniem schematu Hornera?</p>
			</UserMessage>
			<ChatMessage>
				<h2 class="text-[#ECECEC] whitespace-pre-wrap font-semibold text-lg mb-6">Jasne! Spróbuj rozwiązać te zadania samodzielnie, a jeśli napotkasz trudności, skorzystaj z powyższego kalkulatora.</h2>
				<h1 class="text-[#ECECEC] whitespace-pre-wrap font-bold text-xl">Zadanie 1</h1>
				<p>Oblicz wartość wielomianu w punkcie \(x_0=3\):</p>
				<p is:raw>$$W(x)=2x^3-5x^2+3x+4$$</p>
			</ChatMessage>
			<UserMessage>
				<h2 class="text-[#ECECEC] whitespace-pre-wrap font-semibold text-lg mb-2">Zadanie 1</h2>
				<div class="flex flex-row items-center">
					<p>\(W(3) = \) </p>
					<input class="bg-[#303030] text-[#ECECEC] outline-none w-32" id="secondQuestionInput" type="text" placeholder="odpowiedź"/>
					<button onclick="checkAnswer('secondQuestionInput', '22', 'secondQuestionOutput');" type="button" class="relative flex h-8 w-8 right-[-0.625rem] items-center justify-center rounded-full transition-colors hover:opacity-70 focus-visible:outline-none focus-visible:outline-black disabled:text-[#f4f4f4] disabled:hover:opacity-100 dark:focus-visible:outline-white disabled:dark:bg-token-text-quaternary dark:disabled:text-token-main-surface-secondary bg-black text-white dark:bg-white dark:text-black disabled:bg-[#D7D7D7]"><svg width="32" height="32" viewBox="0 0 32 32" fill="none" xmlns="http://www.w3.org/2000/svg" class="icon-2xl"><path fill-rule="evenodd" clip-rule="evenodd" d="M15.1918 8.90615C15.6381 8.45983 16.3618 8.45983 16.8081 8.90615L21.9509 14.049C22.3972 14.4953 22.3972 15.2189 21.9509 15.6652C21.5046 16.1116 20.781 16.1116 20.3347 15.6652L17.1428 12.4734V22.2857C17.1428 22.9169 16.6311 23.4286 15.9999 23.4286C15.3688 23.4286 14.8571 22.9169 14.8571 22.2857V12.4734L11.6652 15.6652C11.2189 16.1116 10.4953 16.1116 10.049 15.6652C9.60265 15.2189 9.60265 14.4953 10.049 14.049L15.1918 8.90615Z" fill="currentColor"></path></svg></button>
				</div>
			</UserMessage>
			<ChatMessage>
				<p>Odpowiedz na zadanie</p>
				<br>
				<p id="secondQuestionOutput"></p>
			</ChatMessage>
			<ChatMessage tags="">
				<h1 class="text-[#ECECEC] whitespace-pre-wrap font-bold text-xl">Ściąga - Wielomiany</h1>
				<h2 class="text-[#ECECEC] whitespace-pre-wrap font-semibold text-lg mt-8 mb-3">Definicja</h2>
				<p>Wielomian to wyrażenie algebraiczne postaci:</p>
				<p class="text-sm" is:raw>$$W(x) = a_n x^n + a_{n-1} x^{n-1} + \ldots + a_1 x + a_0$$</p>
				<p>gdzie:</p>
				<ul>
					<li>\(n\) - stopień wielomianu (najwyższa potęga \(x\)),</li>
					<li is:raw>\(a_n, a_{n-1}, \ldots, a_1, a_0\) - współczynniki wielomianu (liczby rzeczywiste),</li>
					<li>\(a_n \neq 0\).</li>
				</ul>
				<h2 class="text-[#ECECEC] whitespace-pre-wrap font-semibold text-lg mt-6">Działania na wielomianach</h2>
				<ul>
					<li><strong class="font-medium">Dodawanie/odejmowanie</strong> - sumujemy/pomniejszamy współczynniki przy tych samych potęgach.</li>
					<li><strong class="font-medium">Mnożenie</strong> - stosujemy rozdzielność mnożenia względem dodawania.</li>
					<li><strong class="font-medium">Dzielenie</strong> - możemy stosować schemat Hornera lub dzielenie pisemne.</li>
				</ul>
				<h2 class="text-[#ECECEC] whitespace-pre-wrap font-semibold text-lg mt-6">Schemat Hornera - Szybkie obliczanie \(W(x_0)\)</h2>
				<ol>
					<li>Wykonaj schemat Hornera.</li>
					<li>Ostatnia liczba to <strong class="font-medium">reszta</strong> (jeśli 0 - \((x-x_0)\) jest dzielnikiem).</li>
					<li>Pozostałe liczby tworzą wynikowy wielomian o stopień niższy.</li>
				</ol>
				<h2 class="text-[#ECECEC] whitespace-pre-wrap font-semibold text-lg mt-6 mb-3">Twierdzenie Bezouta</h2>
				<p>Jeśli \(W(x_0)=0\), to \((x-x_0)\) jest dzielnikiem \(W(x)\).</p>
				<h2 class="text-[#ECECEC] whitespace-pre-wrap font-semibold text-lg mt-6 mb-3">Rozkład na czynniki</h2>
				<p>Szukamy pierwiastków \(x_0\), dzielimy przez \((x-x_0)\) i powtarzamy dla wynikowego wielomianu.</p>
				<h3 class="text-[#ECECEC] whitespace-pre-wrap font-medium text-base mt-6 mb-1">Przykład</h3>
				<p>\(W(x)=x^3-3x^2+4x-2\)</p>
				<p>Dzielimy przez \((x-2)\), otrzymujemy \(x^2-x+1\).</p>
				<h3 class="text-[#ECECEC] whitespace-pre-wrap font-medium text-base mt-6 mb-1">Warto zapamiętać</h3>
				<ul>
					<li>Stopień iloczynu wielomianów to suma ich stopni.</li>
					<li>Wielomian zerowy ma nieskończenie wiele pierwiastków.</li>
					<li>Każdy wielomian rzeczywisty stopnia \(n\) ma co najwyżej \(n\) pierwiastków.</li>
				</ul>
				<h2 class="text-[#ECECEC] whitespace-pre-wrap font-semibold text-lg mt-2">Szybkie sprawdzenie wyniku? <strong class="font-normal">- podstaw losowe \(x\) i porównaj wartości!</strong></h2>
			</ChatMessage>
		</section>
	</main>
	<style>
		p {
			color: #ECECEC;
			white-space: pre-wrap;
		}

		ul {
			color: #ECECEC;
			white-space: pre-wrap;
			list-style-type: disc;
			list-style-position: inside;
		}

		ol {
			color: #ECECEC;
			white-space: pre-wrap;
			list-style-type: decimal;
			list-style-position: inside;
		}

		li {
			margin-top: -0.5rem;
		}

		input {
			color: #ECECEC;
			outline: none;
			border-bottom: 1px solid #ECECEC;
			flex-grow: 1;
			min-width: 10px;
		}

		.math-container {
			overflow-x: auto;
			margin: 1rem 0;
			padding: 0.5rem 0;
		}
		
		@media (max-width: 640px) {
			.mjx-container {
				font-size: 90% !important;
			}
		}
			
	</style>
	<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
	<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
	<script>
		(window as any).checkAnswer = function(inputId: string, correctAnswer: string, outputId: string) {
			console.log('checkAnswer');
			const input = document.getElementById(inputId);
			const output = document.getElementById(outputId);
			if (input && output) {
				const answer = (input as HTMLInputElement).value;
				if (answer.replace(/\s/g,'').toLowerCase() === correctAnswer.replace(/\s/g,'').toLowerCase()) {
					output.textContent = 'Dobrze!';
				} else {
					output.textContent = 'Źle! Spróbuj jeszcze raz.';
				}
			}
		}
	</script>
	<script is:inline>
    let showRoots = false;

    function calculateRuffini() {
		let coeffs = document.getElementById("coefficients").value.split(",").map(Number);
		let divisorInput = document.getElementById("divisor").value.trim();
		
		if (!divisorInput) {
			document.getElementById("result").innerHTML = 
				'<p class="text-[#FF6666] text-sm">Proszę wprowadzić wartość dzielnika (c).</p>';
			return;
		}
		
		let c = parseFloat(divisorInput);
		
		if (isNaN(c)) {
			document.getElementById("result").innerHTML = 
				'<p class="text-[#FF6666] text-sm">Nieprawidłowa wartość dzielnika. Wprowadź liczbę.</p>';
			return;
		}
		
		if (!coeffs.length || coeffs.every(coeff => coeff === 0)) {
			document.getElementById("result").innerHTML = 
				'<p class="text-[#FF6666] text-sm">Utwórz wielomian przed wykonaniem obliczeń.</p>';
			return;
		}
		
		let n = coeffs.length;
		let row1 = [...coeffs];
		let row2 = Array(n).fill(0);
		let row3 = Array(n).fill(0);
		
		row3[0] = row1[0];

		for (let i = 1; i < n; i++) {
			row2[i] = row3[i - 1] * c;
			row3[i] = row1[i] + row2[i];
		}

		let latexTable = `
			\\[
			\\begin{array}{r|${'r'.repeat(n)}}
			${c} & ${row1.join(" & ")} \\\\ 
				& ${row2.map(x => x === 0 ? "" : x).join(" & ")} \\\\ 
			\\hline
				& ${row3.join(" & ")}
			\\end{array}
			\\]
		`;
		
		let remainder = row3[n-1];
		let factorStatus = Math.abs(remainder) < 0.00001 ? 
			`<p class="text-[#66FF66] font-medium mt-4">(x−${c}) jest dzielnikiem wielomianu!</p>` : 
			`<p class="text-[#ECECEC] mt-4">Reszta z dzielenia: ${remainder}</p>`;
		
		document.getElementById("result").innerHTML = latexTable + factorStatus;
		MathJax.typeset();
		
		drawPolynomialGraph();
	}

    function evaluatePolynomial(coeffs, x) {
        return coeffs.reduce((sum, coeff, i) => 
            sum + coeff * Math.pow(x, coeffs.length - i - 1), 0);
    }

    function findRoots(coeffs) {
        const roots = [];
        const precision = 0.01;
        const samples = 1000;
        
        for (let i = 0; i < samples - 1; i++) 
		{
            const x1 = -10 + (i * 20) / samples;
            const x2 = -10 + ((i + 1) * 20) / samples;
            const y1 = evaluatePolynomial(coeffs, x1);
            const y2 = evaluatePolynomial(coeffs, x2);
            
            if (y1 * y2 <= 0) 
			{
                let a = x1;
                let b = x2;
                let c;
                
                for (let j = 0; j < 10; j++) {
                    c = (a + b) / 2;
                    const yc = evaluatePolynomial(coeffs, c);
                    if (Math.abs(yc) < precision) break;
                    if (yc * evaluatePolynomial(coeffs, a) < 0) {
                        b = c;
                    } else {
                        a = c;
                    }
                }
                
                roots.push((a + b) / 2);
            }
        }
        
        return roots;
    }
    
    function toggleRoots() {
        showRoots = !showRoots;
        drawPolynomialGraph();
    }
    
    function drawPolynomialGraph() {
		const canvas = document.getElementById("polynomialGraph");
		const ctx = canvas.getContext("2d");
		
		const container = canvas.parentElement;
		const displayWidth = container.clientWidth;
		const displayHeight = container.clientHeight;
		
		const pixelRatio = window.devicePixelRatio || 1;
		canvas.width = displayWidth * pixelRatio;
		canvas.height = displayHeight * pixelRatio;
		
		canvas.style.width = `${displayWidth}px`;
		canvas.style.height = `${displayHeight}px`;
		
		ctx.scale(pixelRatio, pixelRatio);
		
		const width = displayWidth;
		const height = displayHeight;
		
		ctx.fillStyle = "#303030";
		ctx.fillRect(0, 0, width, height);
		
		let coeffs = document.getElementById("coefficients").value.split(",").map(Number);
		if (!coeffs.length || coeffs.some(isNaN)) {
			ctx.font = "20px Arial";
			ctx.fillStyle = "#ECECEC";
			ctx.textAlign = "center";
			ctx.fillText("Wprowadź poprawne współczynniki wielomianu", width/2, height/2);
			return;
		}
		
		ctx.strokeStyle = "#444";
		ctx.lineWidth = 0.5;
		ctx.beginPath();
		
		for (let x = -10; x <= 10; x += 1) {
			const screenX = width/2 + x * width/20;
			
			ctx.moveTo(screenX, 0);
			ctx.lineTo(screenX, height);
			
			if (x % 2 === 0 && x !== 0) {
				ctx.fillStyle = "#AAA";
				ctx.font = "12px Arial";
				ctx.textAlign = "center";
				ctx.fillText(x.toString(), screenX, height/2 + 20);
			}
		}
		
		for (let y = -5; y <= 5; y += 1) {
			const screenY = height/2 - y * height/10;
			
			ctx.moveTo(0, screenY);
			ctx.lineTo(width, screenY);
			
			if (y % 2 === 0 && y !== 0) {
				ctx.fillStyle = "#AAA";
				ctx.font = "12px Arial";
				ctx.textAlign = "right";
				ctx.fillText(y.toString(), width/2 - 10, screenY + 5);
			}
		}
		ctx.stroke();
		
		ctx.beginPath();
		ctx.strokeStyle = "#999";
		ctx.lineWidth = 2;
		
		ctx.moveTo(0, height/2);
		ctx.lineTo(width, height/2);

		ctx.moveTo(width/2, 0);
		ctx.lineTo(width/2, height);
		ctx.stroke();

		ctx.fillStyle = "#CCC";
		ctx.textAlign = "right";
		ctx.fillText("0", width/2 - 8, height/2 + 16);

		ctx.beginPath();
		ctx.strokeStyle = "#00AAFF";
		ctx.lineWidth = 2.5;
		ctx.lineCap = "round";
		ctx.lineJoin = "round";

		const numPoints = width * 2;
		let firstPoint = true;
		
		for (let i = 0; i <= numPoints; i++) {
			const x = ((i / numPoints) * width - width/2) / (width/20);

			const y = evaluatePolynomial(coeffs, x);

			let screenY = height/2 - y * height/10;
			screenY = Math.max(-100, Math.min(height + 100, screenY));

			const screenX = (x * width/20) + width/2;

			if (firstPoint) {
				ctx.moveTo(screenX, screenY);
				firstPoint = false;
			} else {
				ctx.lineTo(screenX, screenY);
			}
		}
		ctx.stroke();

		const divisor = parseFloat(document.getElementById("divisor").value);
		if (!isNaN(divisor)) {
			const screenX = width/2 + divisor * width/20;
			const y = evaluatePolynomial(coeffs, divisor);
			const screenY = height/2 - y * height/10;

			ctx.beginPath();
			ctx.strokeStyle = "rgba(255, 100, 100, 0.5)";
			ctx.lineWidth = 1;
			ctx.setLineDash([4, 4]);
			ctx.moveTo(screenX, screenY);
			ctx.lineTo(screenX, height/2);
			ctx.stroke();
			ctx.setLineDash([]);
			
			ctx.beginPath();
			ctx.fillStyle = "#FF5555";
			ctx.arc(screenX, screenY, 6, 0, 2 * Math.PI);
			ctx.fill();

			ctx.strokeStyle = "#FFFFFF";
			ctx.lineWidth = 1.5;
			ctx.stroke();

			ctx.fillStyle = "#FFFFFF";
			ctx.font = "14px Arial";
			ctx.textAlign = "left";
			ctx.fillText(`W(${divisor}) = ${y.toFixed(2)}`, screenX + 10, screenY - 10);
		}

		if (showRoots) {
			const roots = findRoots(coeffs);
			
			roots.forEach(root => {
				const screenX = width/2 + root * width/20;
				const screenY = height/2;

				ctx.beginPath();
				ctx.strokeStyle = "rgba(80, 255, 80, 0.5)";
				ctx.lineWidth = 1;
				ctx.setLineDash([4, 4]);
				ctx.moveTo(screenX, height/2 - 150);
				ctx.lineTo(screenX, height/2 + 20);
				ctx.stroke();
				ctx.setLineDash([]);

				ctx.beginPath();
				ctx.fillStyle = "#3CFF3C";
				ctx.arc(screenX, screenY, 6, 0, 2 * Math.PI);
				ctx.fill();

				ctx.strokeStyle = "#FFFFFF";
				ctx.lineWidth = 1.5;
				ctx.stroke();

				ctx.fillStyle = "#CCFFCC";
				ctx.textAlign = "center";
				ctx.fillText(`x = ${root.toFixed(2)}`, screenX, screenY - 15);
			});
		}
	}

    function resizeCanvas() {
        const canvas = document.getElementById("polynomialGraph");
        if (!canvas) return;

        const container = canvas.parentElement;
        canvas.width = container.clientWidth;
        canvas.height = container.clientHeight;

        if (document.getElementById("coefficients").value) {
            drawPolynomialGraph();
        }
    }

    window.addEventListener('DOMContentLoaded', resizeCanvas);
    window.addEventListener('resize', resizeCanvas);

    function setupTouchEvents() {
        const canvas = document.getElementById("polynomialGraph");
        if (!canvas) return;
        
        let touchStartX = 0;
        let touchEndX = 0;
        
        canvas.addEventListener('touchstart', function(e) {
            touchStartX = e.changedTouches[0].screenX;
        }, false);
        
        canvas.addEventListener('touchend', function(e) {
            touchEndX = e.changedTouches[0].screenX;
            handleSwipe();
        }, false);
        
        function handleSwipe() {
            if (touchEndX < touchStartX - 50) {
                zoomPolynomial(1.2);
            }
            
            if (touchEndX > touchStartX + 50) {
                zoomPolynomial(0.8);
            }
        }
        
        function zoomPolynomial(factor) {
        }
    }

	let polynomial = [0];

	function addTerm(power) {
		while (polynomial.length <= power) {
			polynomial.unshift(0);
		}

		polynomial[polynomial.length - power - 1]++;
		
		updatePolynomialDisplay();
		
		document.getElementById("coefficients").value = polynomial.join(',');
	}

	function subtractTerm(power) {
		while (polynomial.length <= power) {
			polynomial.unshift(0);
		}
		
		polynomial[polynomial.length - power - 1]--;
		
		updatePolynomialDisplay();
		
		document.getElementById("coefficients").value = polynomial.join(',');
	}

	function resetPolynomial() {
		polynomial = [0];
		updatePolynomialDisplay();
		document.getElementById("coefficients").value = "0";
	}

	function updatePolynomialDisplay() {
		let display = "W(x) = ";
		let hasTerms = false;
		
		polynomial.forEach((coeff, index) => {
			const power = polynomial.length - index - 1;
			if (coeff !== 0) {
			if (hasTerms && coeff > 0) display += " + ";
			if (coeff < 0) display += " - ";
			
			const absCoeff = Math.abs(coeff);
			if (absCoeff !== 1 || power === 0) display += absCoeff;
			
			if (power > 0) {
				display += "x";
				if (power > 1) display += "<sup>" + power + "</sup>";
			}
			
			hasTerms = true;
	}
	});
	
	if (!hasTerms) display += "0";
		document.getElementById("currentPolynomial").innerHTML = display;
	}

	function visualizePolynomial() {
		document.getElementById("coefficients").value = polynomial.join(',');
		drawPolynomialGraph();
	}

    window.addEventListener('DOMContentLoaded', setupTouchEvents);
</script>
</Layout>
```astro